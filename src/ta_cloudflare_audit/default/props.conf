# DO NOT EDIT THIS FILE!
# Please make all changes to files in ../local.
# To make changes, copy the section/stanza you want to change from ./default
# into ../local and edit there.

# --------------------------------------
# cloudflare:audit
# --------------------------------------
[cloudflare:audit]
ANNOTATE_PUNCT      = false
category            = Network & Security
description         = Audit events from Cloudflare.
INDEXED_EXTRACTIONS = JSON
KV_MODE             = none
SHOULD_LINEMERGE    = 0
TIMESTAMP_FIELDS    = when
FIELDALIAS-user     = actor.email AS user
FIELDALIAS-user_id  = actor.id AS user_id
FIELDALIAS-src_ip   = actor.ip AS src_ip
FIELDALIAS-src      = actor.ip AS src
EVAL-action         = if('action.result'=="true", "success", "failure")

# --------------------------------------
# Add-on internal logs
# --------------------------------------
[source::...ta_cloudflare_audit*.log*]
ANNOTATE_PUNCT = false
sourcetype = tacloudflareaudit:log
